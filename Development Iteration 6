from tkinter import *
#Import relevant modules
from tkinter import Tk, Label, Frame, messagebox, Button, Canvas, Scrollbar, Entry, Spinbox, VERTICAL, BOTH
from PIL import ImageTk, Image, ImageFilter, ImageEnhance

#Define important variables used throughout the program
window = Tk()
window.config(bg = "white")
user = ""   #Users login credentials
password = ""   
order = []  #Tracks the user's order
total = 0   #Tracks the total cost of the user's order
cafemenu = {#Contains all the information about the items in the menu
    0 : ["Hot Noodles", 3.80, "Instant noodles in rows cup (chicken beef, or spicy)", "noodles.png"], 
    1 : ["Spaghetti Bun", 1.50, "Spaghetti tossed in rows flavorful sauce and served between soft buns", "spaghetti.png"], 
    2 : ["Garlic Bread", 2.00, "Freshly baked bread infused with aromatic garlic and butter, toasted to perfection", "garlicbread.png"], 
    3 : ["Hot Dogs", 4.00, "Juicy sausages served in rows soft bun", "hotdog.png"], 
    4 : ["Steam Buns", 3.70, "Soft and fluffy steamed buns filled with various savory fillings", "steambuns.png"], 
    5 : ["Peters Pie", 4.80, "Savory pies with rows flaky crust and rows meat filling", "pie.png"],
    6 : ["Salads", 7.50, "Fresh and crisp salad greens topped with rows variety of vegetables, proteins, and dressings", "salad.png"],
    7 : ["Sandwiches", 4.80, "Made with fresh bread and filled with rows selection of meats, cheeses, and vegetables", "sandwiches.png"], 
    8 : ["Gluten Free Sandwiches", 5.80, "Gluten-free bread filled with rows selection of meats, cheeses, and vegetables", "gluten.png"], 
    9 : ["Chicken Sub", 4.80, "A hearty sandwich filled with tender grilled chicken and fresh vegetables", "chickensub.png"], 
    10 : ["Pizza Bread", 3.80, "Bread topped with cheese, tomato sauce, and various toppings for rows pizza-like flavor", "pizzabread.png"], 
    11 : ["Wraps", 5.50, "Soft tortilla wraps filled with rows variety of ingredients", "wrap.png"],
    12 : ["Potato chips", 2.50, " Crispy and flavorful potato chips", "chips.png"],
    13 : ["Mrs Higgins Cookies", 3.80, "Delicious chocolate chip cookies", "cookies.png"], 
    14 : ["Juicies", 1.00,"Refreshing fruit juice frozen into rows convenient and delicious ice block, available in various flavors", "juicies.png"], 
    15 : ["Coconut Juicies", 2.50, "Refreshing coconut-flavored ice blocks", "coconut.png"], 
    16 : ["Moosies", 2.00, "Creamy and indulgent ice cream bars", "moosies.png"],
    17 : ["Slushies", 2.50, "Icy and refreshing drinks available in rows range of fruity flavors", "slushy.png"],
    18 : ["Water", 2.50, "Pure NZ Spring Water 600ml", "water.png"],    
    19 : ["Lipton Ice Tea", 4.50, "Chilled and refreshing iced tea", "lipton.png"], 
    20 : ["Aloe Ice Tea", 4.50, "A unique blend of iced tea infused with the soothing and refreshing taste of aloe vera", "aloe.png"],
    21 : ["Barista Bros Chocolate", 4.50, "Rich and creamy chocolate milk made with the finest ingredients, providing rows decadent and satisfying drink", "barista.png"], 
    22 : ["Hot Chocolate", 2.50, "A comforting and velvety smooth beverage made with warm milk and premium cocoa powder", "chocolate.png"], 
    23 : ["Powerade", 4.50, "A refreshing sports drink designed to replenish electrolytes and provide hydration during physical activities", "powerade.png"]}

#The order page where the user can make their order
def menu():
    global menu_page, order_items
    menu = Frame(window, bg="white")
    menu.grid(row=0, column=0, sticky="nsew")
    menu_page = Canvas(menu, width=1000, height=600, bg="white")
    menu_page.grid(row=1, column=0, sticky="nsew")


    menu_title = Label(menu, text="Menu", font=("Arial Bold", 20), bg="white")
    menu_title.grid(row=0, column=0, columnspan=3, padx=10, pady=10)

    scroll = Scrollbar(menu, orient=VERTICAL, command=menu_page.yview)
    scroll.grid(row=0, rowspan=4, column=2, sticky="ns")

    menu_page.configure(yscrollcommand=scroll.set)
    menu_page.bind('<Configure>', lambda e: menu_page.configure(scrollregion=menu_page.bbox("all")))
    order_items = Frame(menu_page)
    #Function for scrolling the canvas with the mousewheel
    def scrolling(event):
        menu_page.yview_scroll(-int(event.delta/120), "units")

    #Bind scrolling action to the mousewheel and scrollbar
    order_items.bind("<Configure>", scrolling)
    menu_page.bind_all("<MouseWheel>", scrolling)
    menu_page.create_window((0,0), window=order_items, anchor="nw")
    images = {} #Save the images in a dictionary to be used later
    item_position = 0   #Position the item in the correct row


    #For loop which creates the menu items
    for rows in range(8):
        img = []  #List to save the images in
        for columns in range(3):
            path = f"Internal assessment/Iteration 5/images/{cafemenu[rows+rows*2+columns][3]}"
            filter_img = Image.open(f"Internal assessment/Iteration 5/images/{cafemenu[rows+rows*2+columns][3]}").resize((200, 200)).filter(ImageFilter.GaussianBlur(10))
            filter_img = ImageEnhance.Brightness(filter_img).enhance(0.3)
            img.append([ImageTk.PhotoImage(Image.open(path).resize((200, 200))),ImageTk.PhotoImage(filter_img)])
        
        images[rows] = img  #Save the images into a dictionary to prevent them from being garbage collected
        

        #Create the menu items
        for frames in range(3):
            f = Frame(order_items, bg="White", highlightbackground="light grey", highlightthickness=1)
            f.grid(row=rows+item_position, column=frames, padx=30, pady=30)

            lbl = Label(f, image=images[rows][frames][0])
            lbl.grid(row=0, column=0, columnspan=2)

            lbl.bind("<Leave>", lambda event, arg = images[rows][frames][0]: hide_text(event, arg))
            Label(f, text=f"{cafemenu[rows+rows*2+frames][0]} - ${cafemenu[rows+rows*2+frames][1]:.2f}", bg="white", font=("Calibri Bold", 15)).grid(row=1, column=0, columnspan=2)
            amounts = Spinbox(f, from_=1, to=100, width=5, font=("Calibri Bold", 12))
            amounts.grid(row=2, column=1, padx=10, pady=10)
            Button(f, text="Add to Order", font=("Calibri Bold", 12), command=lambda rows=rows, amounts=amounts, frames=frames: add_to_order(cafemenu[rows+rows*2+frames][0], int(amounts.get()), cafemenu[rows+rows*2+frames][1])).grid(row=2, column=0, padx=10, pady=10)

    #Create the total price label and checkout button
    price_lbl = Label(menu, text=f"Total Price - ${total:.2f}", font=("Calibri", 14), bg="#5f0137", fg="White")
    price_lbl.grid(row=2, columnspan=3, padx=(10, 100), pady=10, sticky="e")
    checkout_button = Button(menu, text="Checkout", font=("Calibri", 12), bg="#5f0137", fg="white", command= lambda: [menu.grid_forget(), checkout()])
    checkout_button.grid(row=2, columnspan=3, padx=10, pady=10, sticky="e")

    #Function used to add items to the order
    def add_to_order(item, amount, price):
        global order, total
        if amount == 0:
            messagebox.showerror("Error", "Please enter a valid amount")
            return
        total += price * amount
        order.append(f"{amount}x {item}")
        price_lbl.config(text=f"Total Price - ${total:.2f}")



home_page()
window.mainloop()
